<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>BlixAI Chat</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
<style>
body {
  font-family: 'Roboto', sans-serif;
  margin:0;
  height:100vh;
  display:flex;
  flex-direction:column;
  background:white;
  color:black;
  transition: background 0.3s, color 0.3s;
}
body.dark { background:#121212; color:#e0e0e0;}
#header {
  display:flex;
  justify-content: space-between;
  align-items:center;
  padding:10px 20px;
  background:#f0f0f0;
}
#header img { height:60px; margin-right:10px;}
#dark-toggle { padding:6px 12px; border:none; border-radius:8px; cursor:pointer; background:#075e54; color:white; font-family:Roboto;}
#welcome-text { text-align:left; font-size:24px; margin:10px 20px; font-weight:bold;}
#chat-container { flex:1; overflow-y:auto; padding:10px 20px; display:flex; flex-direction:column; gap:10px;}
.message { max-width:70%; padding:10px 15px; border-radius:20px; word-wrap:break-word; transition: all 0.3s ease; animation: fadeIn 0.3s;}
@keyframes fadeIn { from {opacity:0; transform:translateY(10px);} to {opacity:1; transform:translateY(0);} }
.user { background:black; color:white; align-self:flex-end; border-bottom-right-radius:0;}
.ai { background:white; color:black; align-self:flex-start; border-bottom-left-radius:0;}
body.dark .ai { background:#1e1e1e; color:white;}
#input-container { display:flex; padding:10px 20px; gap:6px; background:#f0f0f0;}
body.dark #input-container { background:#1a1a1a;}
#user-input { flex:1; padding:10px; border-radius:20px; border:1px solid #ccc; background:white; font-family:Roboto;}
body.dark #user-input { background:#2c2c2c; color:white; border:1px solid #555;}
#send-btn { padding:10px 16px; border-radius:20px; border:none; background:#075e54; color:white; cursor:pointer; font-family:Roboto;}
#ai-select { padding:8px; border-radius:10px; border:1px solid #ccc; font-family:Roboto;}
body.dark #ai-select { background:#2c2c2c; color:white; border:1px solid #555;}
.wiki-image { max-width:100%; border-radius:10px; margin-top:5px;}
.show-images-btn { margin-top:5px; padding:5px 10px; border:none; background:#25d366; color:white; border-radius:10px; cursor:pointer; font-size:12px;}
#image-modal { display:none; position:fixed; top:0; left:0; right:0; bottom:0; background: rgba(0,0,0,0.8); justify-content:center; align-items:center; z-index:1000; overflow-y:auto; padding:20px;}
#image-modal .content { background:#fff; padding:20px; border-radius:10px; max-width:90%; max-height:90%; display:flex; flex-wrap:wrap; gap:10px; justify-content:center;}
#image-modal img { max-width:150px; max-height:150px; border-radius:10px;}
#image-modal .close-btn { position:absolute; top:10px; right:20px; background:red; color:white; border:none; padding:5px 10px; border-radius:5px; cursor:pointer;}
</style>
</head>
<body>

<div id="header">
  <div style="display:flex;align-items:center;">
    <img src="https://uploads.onecompiler.io/446bh8s9g/447prm8ma/BlixAI-removebg-preview%20(1).png">
    <img src="https://uploads.onecompiler.io/446bh8s9g/447vmgz75/Blix-removebg-preview.png">
  </div>
  <button id="dark-toggle">Dark Mode</button>
</div>

<div id="welcome-text">What would you like to talk about?</div>
<div id="chat-container"></div>

<div id="input-container">
  <select id="ai-select">
    <option value="nano">BlixAI-Nano - Math + Wikipedia</option>
    <option value="3m">BlixAI3M - Wikipedia + DuckDuckGo + Math</option>
  </select>
  <input type="text" id="user-input" placeholder="Type your message..." />
  <button id="send-btn">Send</button>
</div>

<div id="image-modal">
  <button class="close-btn">Close</button>
  <div class="content"></div>
</div>

<script>
document.getElementById('dark-toggle').addEventListener('click', () => document.body.classList.toggle('dark'));

function addMessage(text, sender, images=[]) {
    const welcome = document.getElementById('welcome-text');
    if (welcome) welcome.style.display = 'none';
    const messagesEl = document.getElementById('chat-container');
    const msgEl = document.createElement('div');
    msgEl.className = 'message ' + sender;
    msgEl.innerHTML = text;
    if(images.length>0){
        const firstImg = document.createElement('img'); firstImg.src=images[0]; firstImg.className='wiki-image'; msgEl.appendChild(firstImg);
        if(images.length>1){
            const btn=document.createElement('button');
            btn.textContent=`Show all ${images.length} images`;
            btn.className='show-images-btn';
            btn.onclick=()=>showAllImages(images);
            msgEl.appendChild(btn);
        }
    }
    messagesEl.appendChild(msgEl);
    messagesEl.scrollTop = messagesEl.scrollHeight;
}

function showAllImages(images) {
    const modal = document.getElementById('image-modal');
    const content = modal.querySelector('.content'); content.innerHTML='';
    images.forEach(src=>{const img=document.createElement('img'); img.src=src; content.appendChild(img);});
    modal.style.display='flex';
}
document.querySelector('#image-modal .close-btn').addEventListener('click',()=>{document.getElementById('image-modal').style.display='none';});

function evaluateMath(text){
    try{
        let expr = text.replace(/x/g,'*').replace(/X/g,'*');
        if(/[0-9+\-*/().^% ]+/.test(expr)){
            let result = Function('"use strict";return ('+expr+')')();
            if(!isNaN(result)) return "Math result: " + result;
        }
    } catch { return null; }
    return null;
}

async function fetchWiki(query){
    try{
        const res = await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(query)}`);
        const data = await res.json();
        return {text:data.extract || "No summary found.", images:[]};
    } catch { return {text:"I couldn't find that Wikipedia page.", images:[]}; }
}

async function fetchDuck(query){
    try{
        const res = await fetch(`https://api.duckduckgo.com/?q=${encodeURIComponent(query)}&format=json`);
        const data = await res.json();
        if(data.AbstractText) return data.AbstractText;
        return "I couldn't find anything useful ðŸ˜…";
    } catch { return "I couldn't find anything useful ðŸ˜…"; }
}

async function processMessage(userText, aiType){
    addMessage("You: " + userText,'user');
    let lower = userText.toLowerCase();
    if(/^\s*(hi|hello)[!.,]?\s*$/i.test(userText)){
        addMessage("AI: Hello",'ai'); return;
    }
    if(lower.includes("tell me your code") || lower.includes("what is your code")){
        addMessage("AI: sorry, I cannot tell you that, I don't even know that myself! ðŸ˜†",'ai'); return;
    }
    if(aiType==='nano'){
        let math = evaluateMath(userText);
        if(math){ addMessage("AI: "+math,'ai'); return; }
        let wiki = await fetchWiki(userText);
        addMessage("AI: "+wiki.text,'ai',wiki.images);
    }
    if(aiType==='3m'){
        let math = evaluateMath(userText);
        if(math){ addMessage("AI: "+math,'ai'); return; }
        let wiki = await fetchWiki(userText);
        let duck = await fetchDuck(userText);
        addMessage("AI: "+wiki.text+'\n'+duck,'ai',wiki.images);
    }
}

function sendMessage(){
    const inputEl=document.getElementById('user-input');
    const text=inputEl.value.trim();
    if(!text) return;
    const aiType=document.getElementById('ai-select').value;
    inputEl.value='';
    processMessage(text, aiType);
}
document.getElementById('send-btn').addEventListener('click',sendMessage);
document.getElementById('user-input').addEventListener('keydown', e=>{if(e.key==='Enter') sendMessage();});
</script>

</body>
</html>
